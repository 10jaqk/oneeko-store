<div class="op-gallery op-gallery--stacked" data-product-gallery>
  {%- if product.images.size > 0 -%}
    <!-- Main Image -->
    <div class="op-gallery__main pg-main">
      <img
        id="main-product-image"
        src="{{ product.featured_image | img_url: '1000x' }}"
        srcset="{{ product.featured_image | img_url: '400x' }} 400w,
                {{ product.featured_image | img_url: '600x' }} 600w,
                {{ product.featured_image | img_url: '800x' }} 800w,
                {{ product.featured_image | img_url: '1000x' }} 1000w"
        sizes="(max-width: 768px) 100vw, (max-width: 992px) 60vw, 800px"
        alt="{{ product.featured_image.alt | escape }}"
        class="pg-main-image"
        data-main-image
        loading="eager"
      >
    </div>

    <!-- Thumbnails (Below Main Image) -->
    {%- if product.images.size > 1 -%}
      <div class="op-gallery__thumbs pg-thumbs" aria-label="Product thumbnails">
        {%- for image in product.images limit: 10 -%}
          <button
            type="button"
            class="thumb thumbnail-item {% if forloop.first %}active{% endif %}"
            data-thumbnail
            data-image-src="{{ image | img_url: '1000x' }}"
            data-image-srcset="{{ image | img_url: '400x' }} 400w, {{ image | img_url: '600x' }} 600w, {{ image | img_url: '800x' }} 800w, {{ image | img_url: '1000x' }} 1000w"
          >
            <img
              src="{{ image | img_url: '120x' }}"
              alt="{{ image.alt | escape }}"
              loading="lazy"
            >
          </button>
        {%- endfor -%}
      </div>
    {%- endif -%}
  {%- else -%}
    <div class="op-gallery__placeholder">
      {{ 'product-1' | placeholder_svg_tag }}
    </div>
  {%- endif -%}
</div>


<script>
  // Product Gallery
  document.querySelectorAll('[data-thumbnail]').forEach(thumbnail => {
    thumbnail.addEventListener('click', function() {
      const mainImage = document.querySelector('[data-main-image]');
      const newSrc = this.dataset.imageSrc;
      const newSrcset = this.dataset.imageSrcset;

      // Update main image
      mainImage.src = newSrc;
      if (newSrcset) {
        mainImage.srcset = newSrcset;
      }

      // Update active state
      document.querySelectorAll('[data-thumbnail]').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
    });
  });
</script>
